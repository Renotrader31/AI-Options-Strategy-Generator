<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üóëÔ∏è Delete Trade Functionality Test</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            max-width: 900px; 
            margin: 50px auto; 
            padding: 20px;
            background: #f5f5f5;
        }
        .container { 
            background: white; 
            padding: 30px; 
            border-radius: 10px; 
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .trade-item { 
            margin: 15px 0; 
            padding: 15px; 
            border: 2px solid #e0e0e0; 
            border-radius: 5px; 
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .trade-info {
            flex: 1;
        }
        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .delete-btn:hover { background: #c82333; }
        .add-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 1rem;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .add-btn:hover { background: #218838; }
        .stats {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üóëÔ∏è Delete Trade Functionality Test</h1>
        <p>This test simulates the delete trade functionality with confirmation dialogs.</p>
        
        <div class="stats" id="stats">
            <strong>Portfolio Stats:</strong> <span id="tradeCount">0</span> trades
        </div>
        
        <button class="add-btn" onclick="addSampleTrade()">‚ûï Add Sample Trade</button>
        
        <div id="tradesList">
            <!-- Trades will be displayed here -->
        </div>
        
        <div id="emptyMessage" style="text-align: center; padding: 40px; color: #666; display: none;">
            <div style="font-size: 3rem; margin-bottom: 10px;">üìà</div>
            <div style="font-size: 1.2rem; margin-bottom: 5px;">No trades found</div>
            <div style="font-size: 0.9rem;">Add a sample trade to test the delete functionality!</div>
        </div>
    </div>

    <script>
        // Simulated trades storage
        let trades = [];
        let tradeIdCounter = 1;

        // Sample trade templates
        const sampleTrades = [
            { symbol: 'AAPL', type: 'BUY', assetType: 'STOCK', quantity: 100, entryPrice: 150.00, status: 'active' },
            { symbol: 'TSLA', type: 'BUY_TO_OPEN', assetType: 'OPTION', quantity: 5, entryPrice: 2.50, status: 'active' },
            { symbol: 'SPY', type: 'MULTI_LEG', assetType: 'MULTI_LEG_OPTION', strategyName: 'Iron Condor', quantity: 1, entryPrice: 1.25, status: 'active' },
            { symbol: 'QQQ', type: 'SELL', assetType: 'STOCK', quantity: 50, entryPrice: 380.00, status: 'closed' },
            { symbol: 'NVDA', type: 'BUY_TO_OPEN', assetType: 'OPTION', quantity: 3, entryPrice: 5.75, status: 'closed' }
        ];

        // Add sample trade
        function addSampleTrade() {
            const template = sampleTrades[Math.floor(Math.random() * sampleTrades.length)];
            const newTrade = {
                id: `trade_${tradeIdCounter++}`,
                ...template,
                entryDate: new Date().toISOString(),
                pnl: Math.random() > 0.5 ? Math.random() * 500 - 250 : 0
            };
            
            trades.push(newTrade);
            updateDisplay();
            console.log('‚ûï Added trade:', newTrade);
        }

        // Delete trade with confirmation (simulates the app's functionality)
        function handleDeleteTrade(tradeToDelete) {
            // Show confirmation dialog (same as in the app)
            const isConfirmed = confirm(
                `Are you sure you want to delete this trade?\n\n` +
                `Symbol: ${tradeToDelete.symbol}\n` +
                `Type: ${tradeToDelete.assetType === 'MULTI_LEG_OPTION' ? tradeToDelete.strategyName : tradeToDelete.type}\n` +
                `Quantity: ${tradeToDelete.quantity}\n` +
                `Entry Price: $${tradeToDelete.entryPrice?.toFixed(2)}\n` +
                `Status: ${tradeToDelete.status}\n\n` +
                `This action cannot be undone.`
            );

            if (!isConfirmed) {
                console.log('üö´ Delete cancelled by user');
                return;
            }

            // Remove the trade from the array (simulates the app's logic)
            const initialCount = trades.length;
            trades = trades.filter(trade => trade.id !== tradeToDelete.id);
            const finalCount = trades.length;

            console.log('üóëÔ∏è Trade deleted:', {
                id: tradeToDelete.id,
                symbol: tradeToDelete.symbol,
                tradesRemoved: initialCount - finalCount,
                remainingTrades: finalCount
            });

            // Update display
            updateDisplay();
            
            // Show success message (simulates the app's success message)
            alert(
                `‚úÖ Trade deleted successfully! ${tradeToDelete.symbol} (${tradeToDelete.assetType === 'MULTI_LEG_OPTION' ? tradeToDelete.strategyName : tradeToDelete.type}) removed from portfolio.`
            );
        }

        // Update display
        function updateDisplay() {
            const tradesList = document.getElementById('tradesList');
            const emptyMessage = document.getElementById('emptyMessage');
            const stats = document.getElementById('tradeCount');
            
            // Update stats
            stats.textContent = trades.length;
            
            if (trades.length === 0) {
                tradesList.innerHTML = '';
                emptyMessage.style.display = 'block';
                return;
            }
            
            emptyMessage.style.display = 'none';
            
            // Render trades
            tradesList.innerHTML = trades.map(trade => `
                <div class="trade-item">
                    <div class="trade-info">
                        <div style="font-weight: bold; font-size: 1.1rem;">${trade.symbol}</div>
                        <div style="color: #666; font-size: 0.9rem;">
                            ${trade.assetType === 'MULTI_LEG_OPTION' ? trade.strategyName : trade.type} | 
                            ${trade.assetType} | 
                            Qty: ${trade.quantity} | 
                            Entry: $${trade.entryPrice.toFixed(2)} | 
                            Status: ${trade.status}
                            ${trade.pnl ? ` | P&L: $${trade.pnl.toFixed(2)}` : ''}
                        </div>
                        <div style="color: #999; font-size: 0.8rem;">ID: ${trade.id}</div>
                    </div>
                    <button class="delete-btn" onclick="handleDeleteTrade(${JSON.stringify(trade).replace(/"/g, '&quot;')})">
                        üóëÔ∏è Delete
                    </button>
                </div>
            `).join('');
        }

        // Initialize display
        updateDisplay();

        // Add some initial sample trades
        addSampleTrade();
        addSampleTrade();
        addSampleTrade();
    </script>
</body>
</html>